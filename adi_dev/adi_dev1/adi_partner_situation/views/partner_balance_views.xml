<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <!-- Partner Balance Line Tree View -->
    <record id="partner_balance_line_tree" model="ir.ui.view">
        <field name="name">partner.balance.line.tree</field>
        <field name="model">partner.balance.line</field>
        <field name="arch" type="xml">
            <tree string="Soldes Partenaires" create="false" edit="false" delete="false">
                <field name="partner_ref" optional="show"/>
                <field name="partner_id"/>
                <field name="user_id"/>
                <field name="debit" sum="Total Debit"/>
                <field name="credit" sum="Total Credit"/>
                <field name="balance" sum="Total Solde" decoration-danger="balance &lt; 0" decoration-success="balance &gt; 0"/>
                <button name="action_view_details"
                        type="object"
                        string="Details"
                        icon="fa-list"
                        class="btn-link"/>
            </tree>
        </field>
    </record>

    <!-- Partner Balance Line Search View -->
    <record id="partner_balance_line_search" model="ir.ui.view">
        <field name="name">partner.balance.line.search</field>
        <field name="model">partner.balance.line</field>
        <field name="arch" type="xml">
            <search string="Rechercher Soldes">
                <field name="partner_id"/>
                <field name="partner_ref"/>
                <field name="user_id"/>
                <separator/>
                <filter string="Solde Positif" name="positive_balance" domain="[('balance', '&gt;', 0)]"/>
                <filter string="Solde Negatif" name="negative_balance" domain="[('balance', '&lt;', 0)]"/>
                <filter string="Solde Nul" name="zero_balance" domain="[('balance', '=', 0)]"/>
                <separator/>
                <filter string="Avec Vendeur" name="with_user" domain="[('user_id', '!=', False)]"/>
                <filter string="Sans Vendeur" name="without_user" domain="[('user_id', '=', False)]"/>
                <separator/>
                <group expand="1" string="Grouper par">
                    <filter string="Vendeur" name="group_user" context="{'group_by': 'user_id'}"/>
                    <filter string="Partenaire" name="group_partner" context="{'group_by': 'partner_id'}"/>
                </group>
            </search>
        </field>
    </record>

    <!-- Partner Balance Wizard Form View -->
    <record id="partner_balance_wizard_form" model="ir.ui.view">
        <field name="name">partner.balance.wizard.form</field>
        <field name="model">partner.balance.wizard</field>
        <field name="arch" type="xml">
            <form string="Consulter les Soldes Partenaires">
                <group col="4">
                    <field name="target_move" widget="radio"/>
                    <field name="date_from"/>
                    <field name="date_to"/>
                </group>
                <group col="4">
                    <field name="result_selection"/>
                    <field name="reconciled"/>
                    <newline/>
                    <field name="partner_ids" widget="many2many_tags"
                           options="{'no_open': True, 'no_create': True}"/>
                    <field name="user_ids" widget="many2many_tags"
                           options="{'no_open': True, 'no_create': True}"/>
                </group>
                <group>
                    <field name="company_id" invisible="1"/>
                </group>
                <notebook>
                    <page string="Soldes Partenaires" name="balances">
                        <field name="line_ids" readonly="1" nolabel="1">
                            <tree string="Soldes">
                                <field name="partner_ref" optional="show"/>
                                <field name="partner_id"/>
                                <field name="user_id" optional="show"/>
                                <field name="debit" sum="Total Debit"/>
                                <field name="credit" sum="Total Credit"/>
                                <field name="balance" sum="Total Solde" decoration-danger="balance &lt; 0" decoration-success="balance &gt; 0"/>
                                <button name="action_view_details"
                                        type="object"
                                        string="Details"
                                        icon="fa-list"
                                        class="btn-link"/>
                            </tree>
                        </field>
                    </page>
                </notebook>
                <footer>
                    <button name="action_compute" string="Calculer" type="object" class="oe_highlight" data-hotkey="q"/>
                    <button name="action_view_list" string="Ouvrir en Liste" type="object" class="btn-secondary" data-hotkey="l"/>
                    <button string="Fermer" class="btn-secondary" special="cancel" data-hotkey="z"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Action for Partner Balance Wizard -->
    <record id="action_partner_balance_wizard" model="ir.actions.act_window">
        <field name="name">Consulter les Soldes Partenaires</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">partner.balance.wizard</field>
        <field name="view_mode">form</field>
        <field name="view_id" ref="partner_balance_wizard_form"/>
        <field name="target">new</field>
        <field name="context">{
            'default_target_move': 'posted',
            'default_result_selection': 'customer',
            'default_reconciled': True,
        }</field>
    </record>

</odoo>
