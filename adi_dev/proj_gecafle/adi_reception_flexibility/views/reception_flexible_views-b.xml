<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Vue form héritée pour permettre les modifications -->
    <record id="view_reception_form_flexible" model="ir.ui.view">
        <field name="name">gecafle.reception.form.flexible</field>
        <field name="model">gecafle.reception</field>
        <field name="inherit_id" ref="adi_gecafle_receptions.view_gecafle_reception_form"/>
        <field name="arch" type="xml">
            <!-- Rendre les lignes éditables même après confirmation -->
            <xpath expr="//field[@name='details_reception_ids']" position="attributes">
                <attribute name="readonly">0</attribute>
            </xpath>

            <!-- Message d'info quand confirmé -->
            <xpath expr="//field[@name='details_reception_ids']" position="before">
                <div class="alert alert-info" invisible="state != 'confirmee'">
                    <i class="fa fa-info-circle"/>
                    Vous pouvez modifier les lignes. Les quantités vendues/destockées seront préservées.
                </div>
            </xpath>
        </field>
    </record>
</odoo>
